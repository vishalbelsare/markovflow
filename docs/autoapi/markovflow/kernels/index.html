
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>markovflow.kernels &#8212; markovflow 0.1.0 documentation</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/pydata-custom.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="markovflow.kernels.constant" href="constant/index.html" />
    <link rel="prev" title="markovflow" href="../index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../../index.html">
    
      <img src="../../../_static/logo.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../index.html">Markovflow</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">API Reference</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/secondmind-labs/markovflow" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
          
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#submodules" class="nav-link">Submodules</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#package-contents" class="nav-link">Package Contents</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Constant" class="nav-link">Constant</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.process_covariances" class="nav-link">process_covariances</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.transition_statistics" class="nav-link">transition_statistics</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Constant.variance" class="nav-link">variance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Kernel" class="nav-link">Kernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Kernel.output_dim" class="nav-link">output_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Kernel.build_finite_distribution" class="nav-link">build_finite_distribution</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Kernel.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated" class="nav-link">LatentExponentiallyGenerated</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.LatentExponentiallyGenerated.process_covariances" class="nav-link">process_covariances</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Matern12" class="nav-link">Matern12</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.lengthscale" class="nav-link">lengthscale</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern12.variance" class="nav-link">variance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Matern32" class="nav-link">Matern32</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32._lambda" class="nav-link">_lambda</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.lengthscale" class="nav-link">lengthscale</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern32.variance" class="nav-link">variance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Matern52" class="nav-link">Matern52</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52._lambda" class="nav-link">_lambda</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.lengthscale" class="nav-link">lengthscale</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Matern52.variance" class="nav-link">variance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck" class="nav-link">OrnsteinUhlenbeck</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.decay" class="nav-link">decay</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.OrnsteinUhlenbeck.diffusion" class="nav-link">diffusion</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.HarmonicOscillator" class="nav-link">HarmonicOscillator</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator._lambda" class="nav-link">_lambda</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.process_covariances" class="nav-link">process_covariances</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.variance" class="nav-link">variance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.HarmonicOscillator.period" class="nav-link">period</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.PiecewiseKernel" class="nav-link">PiecewiseKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.initial_covariance" class="nav-link">initial_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.split_time_indices" class="nav-link">split_time_indices</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.split_input" class="nav-link">split_input</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.steady_state_covariances" class="nav-link">steady_state_covariances</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.transition_statistics" class="nav-link">transition_statistics</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.feedback_matrices" class="nav-link">feedback_matrices</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.state_offsets" class="nav-link">state_offsets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.PiecewiseKernel.state_means" class="nav-link">state_means</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.ConcatKernel" class="nav-link">ConcatKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.kernels" class="nav-link">kernels</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.initial_mean" class="nav-link">initial_mean</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.ConcatKernel.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.FactorAnalysisKernel" class="nav-link">FactorAnalysisKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.FactorAnalysisKernel.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.IndependentMultiOutput" class="nav-link">IndependentMultiOutput</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.IndependentMultiOutput.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.IndependentMultiOutputStack" class="nav-link">IndependentMultiOutputStack</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.IndependentMultiOutputStack.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.IndependentMultiOutputStack.__add__" class="nav-link">__add__</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.IndependentMultiOutputStack.__mul__" class="nav-link">__mul__</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.NonStationaryKernel" class="nav-link">NonStationaryKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.NonStationaryKernel.feedback_matrices" class="nav-link">feedback_matrices</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.NonStationaryKernel.state_offsets" class="nav-link">state_offsets</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Product" class="nav-link">Product</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.kernels" class="nav-link">kernels</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Product.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.SDEKernel" class="nav-link">SDEKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.output_dim" class="nav-link">output_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.build_finite_distribution" class="nav-link">build_finite_distribution</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.state_space_model" class="nav-link">state_space_model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.initial_mean" class="nav-link">initial_mean</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.initial_covariance" class="nav-link">initial_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.transition_statistics_from_time_points" class="nav-link">transition_statistics_from_time_points</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.transition_statistics" class="nav-link">transition_statistics</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.state_offsets" class="nav-link">state_offsets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.process_covariances" class="nav-link">process_covariances</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.jitter_matrix" class="nav-link">jitter_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.__add__" class="nav-link">__add__</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.SDEKernel.__mul__" class="nav-link">__mul__</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.StackKernel" class="nav-link">StackKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.state_dim" class="nav-link">state_dim</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.kernels" class="nav-link">kernels</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel._check_batch_shape_is_compatible" class="nav-link">_check_batch_shape_is_compatible</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.state_transitions" class="nav-link">state_transitions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.initial_mean" class="nav-link">initial_mean</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.state_offsets" class="nav-link">state_offsets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StackKernel.initial_covariance" class="nav-link">initial_covariance</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.StationaryKernel" class="nav-link">StationaryKernel</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.initial_mean" class="nav-link">initial_mean</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.set_state_mean" class="nav-link">set_state_mean</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.initial_covariance" class="nav-link">initial_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.transition_statistics" class="nav-link">transition_statistics</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.feedback_matrix" class="nav-link">feedback_matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.state_offsets" class="nav-link">state_offsets</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.steady_state_covariance" class="nav-link">steady_state_covariance</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.StationaryKernel.state_mean" class="nav-link">state_mean</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#markovflow.kernels.Sum" class="nav-link">Sum</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#markovflow.kernels.Sum.generate_emission_model" class="nav-link">generate_emission_model</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-markovflow.kernels">
<span id="markovflow-kernels"></span><h1><a class="reference internal" href="#module-markovflow.kernels" title="markovflow.kernels"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels</span></code></a><a class="headerlink" href="#module-markovflow.kernels" title="Permalink to this headline">¶</a></h1>
<p>Package containing kernels.</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="constant/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.constant</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="kernel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.kernel</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="latent_exp_generated/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.latent_exp_generated</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="matern/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.matern</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="periodic/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.periodic</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="piecewise_stationary/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.piecewise_stationary</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="sde_kernel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel</span></code></a></li>
</ul>
</div>
</div>
<div class="section" id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="markovflow.kernels.Constant">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Constant</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/constant.html#Constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Introduces a constant variance. This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = σ²\]</div>
<p>…where <span class="math notranslate nohighlight">\(σ²\)</span> is a kernel parameter representing the constant variance, which is
supplied as a parameter to the constructor.</p>
<p>The transition matrix <span class="math notranslate nohighlight">\(F\)</span> in the SDE form for this kernel is <span class="math notranslate nohighlight">\(F = [[1]]\)</span>.</p>
<p>Covariance for the steady state is <span class="math notranslate nohighlight">\(P∞ = [[σ²]]\)</span>.</p>
<p>The state transition matrix is <span class="math notranslate nohighlight">\(Aₖ = [[1]]\)</span>.</p>
<p>The process covariance is <span class="math notranslate nohighlight">\(Qₖ = [[0]]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variance</strong> – Initial variance for the kernel. Must be a positive float.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number used to make sure that
matrix inversion is numerically stable.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Constant.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Constant.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Constant.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>The state transition matrix at time step <span class="math notranslate nohighlight">\(k\)</span> is <span class="math notranslate nohighlight">\(Aₖ = [[1]]\)</span>.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Note this is ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.process_covariances">
<code class="sig-name descname"><span class="pre">process_covariances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Constant.process_covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the process covariance matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>The process covariance for time step k is <span class="math notranslate nohighlight">\(Qₖ = [[0]]\)</span>.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
`` batch_shape + [num_transitions]``. Note this is ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.transition_statistics">
<code class="sig-name descname"><span class="pre">transition_statistics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.Constant.transition_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="#markovflow.kernels.Constant.state_transitions" title="markovflow.kernels.Constant.state_transitions"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">state_transitions</span></code></a> and <a class="reference internal" href="#markovflow.kernels.Constant.process_covariances" title="markovflow.kernels.Constant.process_covariances"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">process_covariances</span></code></a>.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Note this is ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two tensors with respective shapes
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Constant.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Constant.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span> of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.
This is given by <span class="math notranslate nohighlight">\(P∞ = [[σ²]]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Constant.variance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Constant.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance parameter.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Kernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Kernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/kernel.html#Kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Module" title="(in TensorFlow v2.4)"><code class="docutils literal notranslate"><span class="pre">tf.Module</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class generating a <a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> for a
given set of time points.</p>
<p>For a given set of time points <span class="math notranslate nohighlight">\(tₖ\)</span>, define a state space model of the form:</p>
<div class="math notranslate nohighlight">
\[xₖ₊₁ = Aₖ xₖ + qₖ\]</div>
<p>…where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;qₖ \sim 𝓝(0, Qₖ)\\
&amp;x₀ \sim 𝓝(μ₀, P₀)\\
&amp;xₖ ∈ ℝ^d\\
&amp;Aₖ ∈ ℝ^{d × d}\\
&amp;Qₖ ∈ ℝ^{d × d}\\
&amp;μ₀ ∈ ℝ^{d × 1}\\
&amp;P₀ ∈ ℝ^{d × d}\\
&amp;d \verb| is the state_dim|\end{split}\]</div>
<p>And an <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmissionModel</span></code></a> for a given output dimension:</p>
<div class="math notranslate nohighlight">
\[fₖ = H xₖ\]</div>
<p>…where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;x ∈ ℝ^d\\
&amp;f ∈ ℝ^m\\
&amp;H ∈ ℝ^{m × d}\\
&amp;m \verb| is the output_dim|\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementations of this class should typically avoid performing computation in their
<code class="xref any docutils literal notranslate"><span class="pre">__init__</span></code> method. Performing computation in the constructor conflicts with
running in TensorFlow’s eager mode.</p>
</div>
<dl class="py method">
<dt id="markovflow.kernels.Kernel.output_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">output_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Kernel.output_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the output dimension of the kernel.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Kernel.build_finite_distribution">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">build_finite_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../gauss_markov/index.html#markovflow.gauss_markov.GaussMarkovDistribution" title="markovflow.gauss_markov.GaussMarkovDistribution"><span class="pre">markovflow.gauss_markov.GaussMarkovDistribution</span></a><a class="headerlink" href="#markovflow.kernels.Kernel.build_finite_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="../gauss_markov/index.html#markovflow.gauss_markov.GaussMarkovDistribution" title="markovflow.gauss_markov.GaussMarkovDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussMarkovDistribution</span></code></a> that this kernel
represents on the provided time points.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently the only representation we can use is a
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The times between which to define the distribution,
with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Kernel.generate_emission_model">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.Kernel.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmissionModel</span></code></a> associated with this kernel
that maps from the latent <a class="reference internal" href="../gauss_markov/index.html#markovflow.gauss_markov.GaussMarkovDistribution" title="markovflow.gauss_markov.GaussMarkovDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussMarkovDistribution</span></code></a>
to the observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined,
with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.LatentExponentiallyGenerated">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">LatentExponentiallyGenerated</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/latent_exp_generated.html#LatentExponentiallyGenerated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents the LEG-GPs kernel.</p>
<p>This kernel defines an SDE with state dimension <span class="math notranslate nohighlight">\(d\)</span>, whose dynamics are governed by:</p>
<div class="math notranslate nohighlight">
\[dx = -½ G x dt + N dw (w Brownian motion)\]</div>
<p>…with <span class="math notranslate nohighlight">\(G = N Nᵀ + R - Rᵀ\)</span>, and <span class="math notranslate nohighlight">\(N, R\)</span> both arbitrary square matrices of
size <span class="math notranslate nohighlight">\(d × d\)</span>.</p>
<p>Note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C = R - Rᵀ\)</span> is skew symmetric <span class="math notranslate nohighlight">\((Cᵀ = -C)\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(d\)</span> is even, <span class="math notranslate nohighlight">\(C\)</span> has imaginary conjugate eigenvalue pairs
<span class="math notranslate nohighlight">\((iλ₁ ,-iλ₁, ...)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(expm(C)\)</span> is an orthogonal matrix (specifying an isometry)</p></li>
</ul>
</div></blockquote>
<p>The key reference is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">loper2020general</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">General</span> <span class="n">linear</span><span class="o">-</span><span class="n">time</span> <span class="n">inference</span> <span class="k">for</span> <span class="n">Gaussian</span> <span class="n">Processes</span> <span class="n">on</span> <span class="n">one</span> <span class="n">dimension</span><span class="p">},</span>
    <span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Loper</span><span class="p">,</span> <span class="n">Jackson</span> <span class="ow">and</span> <span class="n">Blei</span><span class="p">,</span> <span class="n">David</span> <span class="ow">and</span> <span class="n">Cunningham</span><span class="p">,</span> <span class="n">John</span> <span class="n">P</span> <span class="ow">and</span> <span class="n">Paninski</span><span class="p">,</span> <span class="n">Liam</span><span class="p">},</span>
    <span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">arXiv</span> <span class="n">preprint</span> <span class="n">arXiv</span><span class="p">:</span><span class="mf">2003.05554</span><span class="p">},</span>
    <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2020</span><span class="p">}</span>
</pre></div>
</div>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> – The Noise mixing matrix.</p></li>
<li><p><strong>R</strong> – The Rotation inducing matrix.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.LatentExponentiallyGenerated.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.LatentExponentiallyGenerated.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the state transition matrices. That is:</p>
<div class="math notranslate nohighlight">
\[Aₖ = expm[-½G Δtₖ]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – Time points at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – Time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of shape batch_shape + [num_transitions, state_dim, state_dim]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.LatentExponentiallyGenerated.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix.</p>
<p>Here, this is <span class="math notranslate nohighlight">\(F (=-G/2)\)</span> with shape <span class="math notranslate nohighlight">\(d × d\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.LatentExponentiallyGenerated.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the steady state covariance <span class="math notranslate nohighlight">\(P∞ = I\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.LatentExponentiallyGenerated.process_covariances">
<code class="sig-name descname"><span class="pre">process_covariances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.LatentExponentiallyGenerated.process_covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the process covariance at time <span class="math notranslate nohighlight">\(k\)</span>. This is calculated as:</p>
<div class="math notranslate nohighlight">
\[Qₖ = P∞ - Aₖ P∞ Aₖᵀ = I - Aₖ Aₖᵀ\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – Time points at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – Time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Matern12">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Matern12</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/matern.html#Matern12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Matern12" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents the Matern1/2 kernel. This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = σ² exp(-|x - x'| / ℓ)\]</div>
<p>…where lengthscale <span class="math notranslate nohighlight">\(ℓ\)</span> and signal variance <span class="math notranslate nohighlight">\(σ²\)</span> are kernel parameters.</p>
<p>This defines an SDE where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;F = - 1/ℓ\\
&amp;L = 1\end{split}\]</div>
<p>…so that <span class="math notranslate nohighlight">\(Aₖ = exp(-Δtₖ/ℓ)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengthscale</strong> – A value for the lengthscale parameter.</p></li>
<li><p><strong>variance</strong> – A value for the variance parameter.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Matern12.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the kernel, which is always one.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern12.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices kernel.</p>
<p>The state dimension is one, so the matrix exponential reduces to a standard one:</p>
<div class="math notranslate nohighlight">
\[Aₖ = exp(-Δtₖ/ℓ)\]</div>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern12.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<p>For this kernel, note that <span class="math notranslate nohighlight">\(F = - 1 / ℓ\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern12.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span>. For this kernel,
this is the variance hyperparameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern12.lengthscale">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lengthscale</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.lengthscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lengthscale parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern12.variance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern12.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Matern32">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Matern32</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/matern.html#Matern32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Matern32" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents the Matern3/2 kernel. This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = σ² (1 + λ|x - x'|) exp(λ|x - x'|)\]</div>
<p>…where <span class="math notranslate nohighlight">\(λ = √3 / ℓ\)</span>, and lengthscale <span class="math notranslate nohighlight">\(ℓ\)</span> and signal variance <span class="math notranslate nohighlight">\(σ²\)</span>
are kernel parameters.</p>
<p>The transition matrix <span class="math notranslate nohighlight">\(F\)</span> in the SDE form for this kernel is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F = &amp;[[0, 1]\\
    &amp;[[-λ², -2λ]]\end{split}\]</div>
<p>Covariance for the initial state is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}P∞ = [&amp;[1, 0],\\
      &amp;[0, λ²]] * \verb|variance|\end{split}\]</div>
<p>…where <a class="reference internal" href="#markovflow.kernels.Matern32.variance" title="markovflow.kernels.Matern32.variance"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">variance</span></code></a> is a kernel parameter.</p>
<p>Since the characteristic equation for the feedback matrix <span class="math notranslate nohighlight">\(F\)</span> for this kernel
is <span class="math notranslate nohighlight">\((λI + F)² = 0\)</span>, the state transition matrix is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Aₖ &amp;= expm(FΔtₖ)\\
   &amp;= exp(-λΔtₖ) expm((λI + F)Δtₖ)\\
   &amp;= exp(-λΔtₖ) (I + (λI + F)Δtₖ)\end{split}\]</div>
<p>…where <span class="math notranslate nohighlight">\(expm\)</span> is the matrix exponential operator. Note that all higher order terms of
<span class="math notranslate nohighlight">\(expm((λI + F)Δtₖ)\)</span> disappear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengthscale</strong> – A value for the lengthscale parameter.</p></li>
<li><p><strong>variance</strong> – A value for the variance parameter.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Matern32._lambda">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">_lambda</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern32._lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>λ the scalar used elsewhere in the docstrings</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the kernel, which is always two.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices for the kernel.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<p>For this kernel, note that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F = &amp;[0    &amp;1]\\
    &amp;[-λ²  &amp;-2λ]\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span>. This is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}P∞ = σ² [&amp;[1, 0],\\
         &amp;[0, λ²]]\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.lengthscale">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lengthscale</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.lengthscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lengthscale parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern32.variance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern32.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Matern52">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Matern52</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/matern.html#Matern52"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Matern52" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents the Matern5/2 kernel. This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = σ² (1 + λ|x - x'| + λ²|x - x'|²/3) exp(λ|x - x'|)\]</div>
<p>…where <span class="math notranslate nohighlight">\(λ = √5 / ℓ\)</span>, and lengthscale <span class="math notranslate nohighlight">\(ℓ\)</span> and signal variance <span class="math notranslate nohighlight">\(σ²\)</span>
are kernel parameters.</p>
<p>The transition matrix <span class="math notranslate nohighlight">\(F\)</span> in the SDE form for this kernel is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>F = [  0,    1,   0]
    [  0,    0,   1]
    [-λ³, -3λ², -3λ]
</pre></div>
</div>
<p>Covariance for the initial state is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>P∞ = σ² [    1,    0, -λ²/3]
        [    0, λ²/3,     0]
        [-λ²/3,    0,    λ⁴]
</pre></div>
</div>
<p>Since the characteristic equation for the feedback matrix <span class="math notranslate nohighlight">\(F\)</span> for this kernel
is <span class="math notranslate nohighlight">\((λI + F)³ = 0\)</span>, the state transition matrix is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Aₖ &amp;= expm(FΔtₖ)\\
   &amp;= exp(-λΔtₖ) expm((λI + F)Δtₖ)\\
   &amp;= exp(-λΔtₖ) (I + (λI + F)Δtₖ + (λI + F)²Δtₖ²/2)\end{split}\]</div>
<p>…where <span class="math notranslate nohighlight">\(expm\)</span> is the matrix exponential operator. Note that all
higher order terms disappear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengthscale</strong> – A value for the lengthscale parameter.</p></li>
<li><p><strong>variance</strong> – A value for the variance parameter.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Matern52._lambda">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">_lambda</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern52._lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>λ the scalar used elsewhere in the docstrings</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the kernel, which is always three.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices for the kernel.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<p>For this kernel, note that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>F = [[  0,    1,   0]
     [  0,    0,   1]
     [-λ³, -3λ², -3λ]]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span>. This is given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>P∞ = σ² [    1,    0, -λ²/3]
        [    0, λ²/3,     0]
        [-λ²/3,    0,    λ⁴]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.lengthscale">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lengthscale</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.lengthscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lengthscale parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Matern52.variance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.Matern52.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.OrnsteinUhlenbeck">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">OrnsteinUhlenbeck</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/matern.html#OrnsteinUhlenbeck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents the Ornstein–Uhlenbeck kernel.
This is an alternative parameterization of the Matern1/2 kernel.
This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = q/2λ exp(-λ|x - x'|)\]</div>
<p>…where decay <span class="math notranslate nohighlight">\(λ\)</span> and diffusion coefficient <span class="math notranslate nohighlight">\(q\)</span> are kernel parameters.</p>
<p>This defines an SDE where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;F = - λ\\
&amp;L = q\end{split}\]</div>
<p>…so that <span class="math notranslate nohighlight">\(Aₖ = exp(-λ Δtₖ)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decay</strong> – A value for the decay parameter.</p></li>
<li><p><strong>diffusion</strong> – A value for the diffusion parameter.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the kernel, which is always one.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices kernel.</p>
<p>The state dimension is one, so the matrix exponential reduces to a standard one:</p>
<div class="math notranslate nohighlight">
\[Aₖ = exp(-λ Δtₖ)\]</div>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<p>For this kernel, note that <span class="math notranslate nohighlight">\(F = -λ\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span>. For this kernel,
this is q/2λ.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.decay">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">decay</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the decay parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.OrnsteinUhlenbeck.diffusion">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">diffusion</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.OrnsteinUhlenbeck.diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the diffusion parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.HarmonicOscillator">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">HarmonicOscillator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/periodic.html#HarmonicOscillator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></code></a></p>
<p>Represents a periodic kernel. The definition is in the paper <a class="reference external" href="http://proceedings.mlr.press/v33/solin14.pdf">“Explicit Link Between Periodic
Covariance Functions and State Space Models”</a>.</p>
<p>This kernel has the formula:</p>
<div class="math notranslate nohighlight">
\[C(x, x') = σ² cos(2π/p * (x-x'))\]</div>
<p>…where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(σ²\)</span> is a kernel parameter, representing the constant variance
this kernel introduces</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the period of the oscillator in radius</p></li>
</ul>
</div></blockquote>
<p>The transition matrix <span class="math notranslate nohighlight">\(F\)</span> in the SDE form for this kernel is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F = [&amp;[0,  -λ],\\
     &amp;[λ,  0]].\end{split}\]</div>
<p>…where <span class="math notranslate nohighlight">\(λ = 2π / period\)</span>.</p>
<p>Covariance for the steady state is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}P∞ = [&amp;[σ², 0],\\
      &amp;[0,  σ²]].\end{split}\]</div>
<p>The state transition matrix is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Aₖ = [&amp;[cos(Δtₖλ),  -sin(Δtₖλ)],\\
      &amp;[sin(Δtₖλ),  cos(Δtₖλ)]]\end{split}\]</div>
<p>The process covariance is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Qₖ = [&amp;[0, 0],\\
      &amp;[0, 0]].\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variance</strong> – Initial variance for the kernel. Must be a positive float.</p></li>
<li><p><strong>period</strong> – The period of the Harmonic oscillator, in radius. Must be a positive float.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number used to make sure that
matrix inversion is numerically stable.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator._lambda">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">_lambda</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator._lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>λ the scalar used elsewhere in the docstrings</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the kernel.</p>
<p>The state transition matrix at time step <span class="math notranslate nohighlight">\(k\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Aₖ = [&amp;[cos(Δtₖλ),  -sin(Δtₖλ)],\\
      &amp;[sin(Δtₖλ),  cos(Δtₖλ)]].\end{split}\]</div>
<p>…where <span class="math notranslate nohighlight">\(λ = 2π / period\)</span>.</p>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.process_covariances">
<code class="sig-name descname"><span class="pre">process_covariances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.process_covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the kernel.</p>
<p>The process covariance for time step k is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Qₖ = [&amp;[0, 0],\\
      &amp;[0, 0]].\end{split}\]</div>
<p>Because this is a stationary kernel, <code class="xref any docutils literal notranslate"><span class="pre">transition_times</span></code> is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>. Ignored.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<p>For this kernel, note that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F = [&amp;[0,  -λ],\\
     &amp;[λ,  0]].\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial covariance of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>The steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}P∞ = [&amp;[σ², 0],\\
      &amp;[0,  σ²]].\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.variance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.HarmonicOscillator.period">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">period</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow.Parameter" title="(in GPflow v2.1)"><span class="pre">gpflow.Parameter</span></a><a class="headerlink" href="#markovflow.kernels.HarmonicOscillator.period" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the period parameter. This is a GPflow
<a class="reference external" href="https://gpflow.readthedocs.io/en/master/gpflow/index.html#gpflow-parameter">Parameter</a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.PiecewiseKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">PiecewiseKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.StationaryKernel" title="markovflow.kernels.sde_kernel.StationaryKernel"><span class="pre">markovflow.kernels.sde_kernel.StationaryKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.base.TensorType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/piecewise_stationary.html#PiecewiseKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sde_kernel/index.html#markovflow.kernels.sde_kernel.NonStationaryKernel" title="markovflow.kernels.sde_kernel.NonStationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.sde_kernel.NonStationaryKernel</span></code></a></p>
<p>Construct an SDE kernel whose state dynamic is governed by different SDEs. These are on the
<span class="math notranslate nohighlight">\(K+1\)</span> intervals specified by the <span class="math notranslate nohighlight">\(K\)</span> change points <span class="math notranslate nohighlight">\(cₖ\)</span>.</p>
<p>On interval <span class="math notranslate nohighlight">\([cₖ, cₖ₊₁]\)</span>, the dynamics are governed by a SDE kernel <span class="math notranslate nohighlight">\(kₖ\)</span>
where <span class="math notranslate nohighlight">\(c₀ = -∞\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = Fₖ x(t) + Lₖ w(t),\\
&amp;f(t) = Hₖ x(t)\end{split}\]</div>
<p>Note the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>This is currently restricted to cases where the kernels are the same.</p></li>
<li><p>State space models constructed by marginalizing out the process to
time points <span class="math notranslate nohighlight">\(t\)</span> are only valid if no transitions cross a change point.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – An iterable over the kernels forming this kernel.</p></li>
<li><p><strong>change_points</strong> – Sorted change points.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmissionModel</span></code></a> associated with this kernel
that maps from the latent <a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>
to the observations.</p>
<p>The emission matrix is the Kronecker product of all the children emission matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.initial_covariance">
<code class="sig-name descname"><span class="pre">initial_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time_point</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.initial_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial covariance of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This is the covariance of the stationary distribution <span class="math notranslate nohighlight">\(P∞\)</span> for the kernel active at
the time passed in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_time_point</strong> – The time point associated with the first state, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[1,]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.split_time_indices">
<code class="sig-name descname"><span class="pre">split_time_indices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.split_time_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives each time point an index that refers to which interval it resides in.</p>
<p>The sub-kernel that governs the SDE is different on different sub intervals,
as specified by the change points.</p>
<p>If there are <span class="math notranslate nohighlight">\(K\)</span> change points, then <span class="math notranslate nohighlight">\(0\)</span> is the index before the first
change point and <span class="math notranslate nohighlight">\(K + 1\)</span> is the index after the last change point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of indices in range 0 - <code class="xref any docutils literal notranslate"><span class="pre">num_change_points</span></code>, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.split_input">
<code class="sig-name descname"><span class="pre">split_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.split_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions <code class="xref any docutils literal notranslate"><span class="pre">input_tensor</span></code> into regions determined by the change points.</p>
<p>If there are <span class="math notranslate nohighlight">\(K\)</span> change points, then <span class="math notranslate nohighlight">\(0\)</span> is the index before the first
change point and <span class="math notranslate nohighlight">\(K + 1\)</span> is the index after the last change point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> – An arbitrary input tensor, with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[N]</span></code>.</p></li>
<li><p><strong>indices</strong> – The index for each input of the input tensor,
with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[N]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of tensors each with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[Nₖ]</span></code>,
where <span class="math notranslate nohighlight">\((Σₖ Nₖ = N)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.steady_state_covariances">
<code class="sig-name descname"><span class="pre">steady_state_covariances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.steady_state_covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>For each time point, return the steady state covariance of the kernel active for that
time point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The steady state covariance at each time point, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> <span class="math notranslate nohighlight">\(Aₖ = exp(FΔtₖ)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Transitions are only valid if they do not cross a change point.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – Time points at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – Time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.transition_statistics">
<code class="sig-name descname"><span class="pre">transition_statistics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.transition_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#markovflow.kernels.PiecewiseKernel.state_transitions" title="markovflow.kernels.PiecewiseKernel.state_transitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_transitions()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">process_covariances()</span></code> together to
save having to compute them twice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two tensors, with respective shapes
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.feedback_matrices">
<code class="sig-name descname"><span class="pre">feedback_matrices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.feedback_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>For each time point, return the non-stationary feedback matrix <span class="math notranslate nohighlight">\(F(t)\)</span>
of the kernel active for that time point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The feedback matrix at each time point, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.state_offsets">
<code class="sig-name descname"><span class="pre">state_offsets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.state_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state offsets <span class="math notranslate nohighlight">\(bₖ\)</span> of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.
:param transition_times: A tensor of times at which to produce matrices, with shape</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.PiecewiseKernel.state_means">
<code class="sig-name descname"><span class="pre">state_means</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.PiecewiseKernel.state_means" title="Permalink to this definition">¶</a></dt>
<dd><p>For each time point, return the state mean of the kernel active for that
time point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The state mean at each time point <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.ConcatKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">ConcatKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#ConcatKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.StationaryKernel" title="markovflow.kernels.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StationaryKernel</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class implementing the state space model of multiple kernels that have been
combined together. Combined with differing emission models this can give rise to the
<a class="reference internal" href="#markovflow.kernels.Sum" title="markovflow.kernels.Sum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sum</span></code></a> kernel or to a multi-output kernel.</p>
<p>The state space of any <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a> consists of all the state spaces of
child kernels concatenated (in the tensorflow.concat sense) together:</p>
<div class="math notranslate nohighlight">
\[\begin{split}[x¹(t),\\
x²(t)]\end{split}\]</div>
<p>So the SDE of the kernel becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = &amp;[[F¹ 0],     &amp;[x¹(t)    &amp;[[L¹ 0],   &amp;[w¹(t),\\
&amp;           &amp;[0  F²]]     &amp;x²(t)]  + &amp;[0  L²]]   &amp;w²(t)]\\
&amp;f(t) = [H¹ H²] x(t)\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – A list of child kernels that will have their state spaces
concatenated together.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.kernels">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kernels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.ConcatKernel.kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of child kernels.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> <span class="math notranslate nohighlight">\(Aₖ = exp(FΔtₖ)\)</span>.</p>
<p>The state transition matrix is the block diagonal matrix of the child state
transition matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.initial_mean">
<code class="sig-name descname"><span class="pre">initial_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/TensorShape" title="(in TensorFlow v2.4)"><span class="pre">tf.TensorShape</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel.initial_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial mean of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>The combined mean is the child means concatenated together:</p>
<div class="math notranslate nohighlight">
\[[μ1 μ2, ...]\]</div>
<p>…to form a longer mean vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_shape</strong> – A tuple of leading dimensions for the initial mean.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of zeros with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix. This is the block diagonal matrix of
child feedback matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.ConcatKernel.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.ConcatKernel.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance. This is the block diagonal matrix of
child steady state covariance matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.FactorAnalysisKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">FactorAnalysisKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">gpflow.base.TensorType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">gpflow.base.TensorType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#FactorAnalysisKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.FactorAnalysisKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a></p>
<p>Produces an emission model which performs a linear mixing of Gaussian
processes according to a known time varying weight function and a learnable loading matrix:</p>
<div class="math notranslate nohighlight">
\[fᵢ(t) = Σⱼₖ Aᵢⱼ(t)Bⱼₖgₖ(t)\]</div>
<p>…where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{fᵢ\}ₙ\)</span> are the observable processes</p></li>
<li><p><span class="math notranslate nohighlight">\(\{gₖ\}ₘ\)</span> are the latent GPs</p></li>
<li><p><span class="math notranslate nohighlight">\(A^{n × m}\)</span> is a known, possibly time dependant, weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(B^{m × m}\)</span> is either the identity or a trainable loading matrix</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight_function</strong> – A function that, given <code class="xref py py-data docutils literal notranslate"><span class="pre">TensorType</span></code>
time points with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data,</span> <span class="pre">]</span></code>, returns a weight matrix
with the relative mixing of the tensors, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data,</span> <span class="pre">output_dim,</span> <span class="pre">n_latents]</span></code>.</p></li>
<li><p><strong>kernels</strong> – An iterable over child kernels that will have their state spaces
concatenated together, with shape <code class="docutils literal notranslate"><span class="pre">[n_latents,</span> <span class="pre">]</span></code>.</p></li>
<li><p><strong>output_dim</strong> – The output dimension of the kernel. This should have the same shape as
the <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel.output_dim" title="markovflow.emission_model.EmissionModel.output_dim"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">output_dim</span></code></a> of the weight matrix returned by the weight function.</p></li>
<li><p><strong>trainable</strong> – Whether the loading matrix <span class="math notranslate nohighlight">\(B\)</span> should be trainable.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.FactorAnalysisKernel.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.FactorAnalysisKernel.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the emission matrix <span class="math notranslate nohighlight">\(WH\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[H = H₁ ⊕ H₂ ⊕ ... ⊕ Hₙ\]</div>
<p>…as per the multi-output kernel, and <span class="math notranslate nohighlight">\(W = AB\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data,</span> <span class="pre">]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The emission model associated with this kernel.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.IndependentMultiOutput">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">IndependentMultiOutput</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#IndependentMultiOutput"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a></p>
<p>Takes a concatenated state space model consisting of multiple child
kernels and projects the state space associated with each kernel into a separate observation
vector.</p>
<p>The result is similar to training several kernels on the same data separately,
except that because of the covariance terms in the state space there can be correlation
between the separate observation vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – An iterable over child kernels which will have their state spaces
concatenated together.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.IndependentMultiOutput.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutput.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the emission matrix <span class="math notranslate nohighlight">\(H\)</span>. This is the direct sum of the child emission
matrices, for example:</p>
<div class="math notranslate nohighlight">
\[H = H₁ ⊕ H₂ ⊕ ... ⊕ Hₙ\]</div>
<p>…where <span class="math notranslate nohighlight">\(\{Hᵢ\}ₙ\)</span> are the emission matrices of the child kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The emission model associated with this kernel.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.IndependentMultiOutputStack">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">IndependentMultiOutputStack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#IndependentMultiOutputStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutputStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.StackKernel" title="markovflow.kernels.StackKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StackKernel</span></code></a></p>
<p>Takes a stacked state space model consisting of multiple child kernels and projects the
state space associated with each kernel into a separate observation vector.</p>
<p>The result is similar to training several kernels on the same data separately.
There will be no correlations between the processes, in the prior or the posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – An iterable over child kernels which will have their state spaces
concatenated together. Since we model each output independently the length of the
kernel list defines the number of the outputs.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.IndependentMultiOutputStack.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutputStack.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the emission matrix <span class="math notranslate nohighlight">\(H\)</span>. This is a stacking of the child emission matrices,
which are first augmented (if necessary) so that they have the same state_dim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code> where <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">=</span> <span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The emission model associated with this kernel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.IndependentMultiOutputStack.__add__">
<code class="sig-name descname"><span class="pre">__add__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#markovflow.kernels.IndependentMultiOutputStack" title="markovflow.kernels.IndependentMultiOutputStack"><span class="pre">IndependentMultiOutputStack</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#markovflow.kernels.IndependentMultiOutputStack" title="markovflow.kernels.IndependentMultiOutputStack"><span class="pre">IndependentMultiOutputStack</span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutputStack.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator for combining kernel objects by summing them.</p>
<p>Overrides the base class <a class="reference internal" href="#markovflow.kernels.SDEKernel.__add__" title="markovflow.kernels.SDEKernel.__add__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SDEKernel.__add__()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.IndependentMultiOutputStack.__mul__">
<code class="sig-name descname"><span class="pre">__mul__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#markovflow.kernels.IndependentMultiOutputStack" title="markovflow.kernels.IndependentMultiOutputStack"><span class="pre">IndependentMultiOutputStack</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#markovflow.kernels.IndependentMultiOutputStack" title="markovflow.kernels.IndependentMultiOutputStack"><span class="pre">IndependentMultiOutputStack</span></a><a class="headerlink" href="#markovflow.kernels.IndependentMultiOutputStack.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator for combining kernel objects by multiplying them.</p>
<p>Overrides the base class <a class="reference internal" href="#markovflow.kernels.SDEKernel.__mul__" title="markovflow.kernels.SDEKernel.__mul__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SDEKernel.__mul__()</span></code></a> method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.NonStationaryKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">NonStationaryKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#NonStationaryKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.NonStationaryKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SDEKernel</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class representing non-stationary kernels defined by the Stochastic Differential
Equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = F(t) x(t) + L(t) w(t),\\
&amp;f(t) = H(t) x(t)\end{split}\]</div>
<p>For most kernels <span class="math notranslate nohighlight">\(H\)</span> will not be time varying; that is, <span class="math notranslate nohighlight">\(f(t) = H x(t)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.NonStationaryKernel.feedback_matrices">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">feedback_matrices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.NonStationaryKernel.feedback_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>The non-stationary feedback matrix <span class="math notranslate nohighlight">\(F(t)\)</span> at times <span class="math notranslate nohighlight">\(t\)</span>, where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F(t) x(t) + L w(t)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The times at which the feedback matrix is evaluated, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_time_points,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.NonStationaryKernel.state_offsets">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">state_offsets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.NonStationaryKernel.state_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state offsets <span class="math notranslate nohighlight">\(bₖ\)</span> of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.
:param transition_times: A tensor of times at which to produce matrices, with shape</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Product">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Product</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#Product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Product" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.StationaryKernel" title="markovflow.kernels.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StationaryKernel</span></code></a></p>
<p>Multiplies a list of child kernels.</p>
<p>The feedback matrix is the Kronecker product of the feedback matrices from the child kernels.
We will use a product kernel with two child kernels as an example. Let <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> be the feedback matrix from these two child kernels. The feedback matrix <span class="math notranslate nohighlight">\(F\)</span>
of the product kernel is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;F &amp;= &amp;A ⊗ B\\
&amp;  &amp;= &amp;[[A₁₁ B, ..., A₁ₙ B],\\
&amp;  &amp;  &amp;...,\\
&amp;  &amp;  &amp;[Aₙ₁ B, ..., Aₙₙ B]]\end{split}\]</div>
<p>…where <span class="math notranslate nohighlight">\(⊗\)</span> is the Kronecker product operator.</p>
<p>The state transition matrix is the Kronecker product of the state transition matrices from
the child kernels. Let <span class="math notranslate nohighlight">\(Aₖ\)</span> and <span class="math notranslate nohighlight">\(Bₖ\)</span> be the state transition matrix from these two
child kernels at time step <span class="math notranslate nohighlight">\(k\)</span>. The state transition matrix
<span class="math notranslate nohighlight">\(Sₖ\)</span> of the product kernel is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;Sₖ &amp;= &amp;Aₖ ⊗ Bₖ\\
&amp;   &amp;= &amp;[[Aₖ₁₁ Bₖ, ..., Aₖ₁ₙ Bₖ],\\
&amp;   &amp;  &amp;...,\\
&amp;   &amp;  &amp;[Aₖₙ₁ Bₖ, ..., Aₖₙₙ Bₖ]]\end{split}\]</div>
<p>The steady state covariance matrix is the Kronecker product of the steady covariance matrix
from the child kernels. Let <span class="math notranslate nohighlight">\(A∞\)</span> and <span class="math notranslate nohighlight">\(B∞\)</span> be the steady covariance matrix from
these two child kernels. The state transition matrix <span class="math notranslate nohighlight">\(P∞\)</span> of the product kernel is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;P∞ &amp;= &amp;A∞ ⊗ B∞\\
&amp;   &amp;= &amp;[[A∞₁₁ B∞, ..., A∞ B∞],\\
&amp;   &amp;  &amp;...,\\
&amp;   &amp;  &amp;[A∞ₙ₁ B∞, ..., A∞ₙₙ B∞]]\end{split}\]</div>
<p>The process covariance matrix <span class="math notranslate nohighlight">\(Qₖ\)</span> at time step <span class="math notranslate nohighlight">\(k\)</span> is calculated using the
same formula as defined in the parent class SDEKernel:</p>
<div class="math notranslate nohighlight">
\[Qₖ = P∞ - Sₖ P∞ Sₖᵀ\]</div>
<p>…where the steady state matrix <span class="math notranslate nohighlight">\(P∞\)</span> and the state transition <span class="math notranslate nohighlight">\(Sₖ\)</span>
are defined above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – An iterable over the kernels to be multiplied together.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Product.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.Product.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Product.kernels">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kernels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.Product.kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of child kernels.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Product.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Product.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition. This is the Kronecker product of the child state transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Product.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Product.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix. This is the Kronecker product of the child feedback matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Product.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.Product.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance. This is the Kronecker product
of the child steady state covariances.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.Product.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.Product.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the emission matrix. This is the
Kronecker product of all the child emission matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.SDEKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SDEKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#SDEKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="kernel/index.html#markovflow.kernels.kernel.Kernel" title="markovflow.kernels.kernel.Kernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markovflow.kernels.kernel.Kernel</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class representing kernels defined by the Stochastic Differential Equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = F(t) x(t) + L(t) w(t),\\
&amp;f(t) = H(t) x(t)\end{split}\]</div>
<p>For most kernels <span class="math notranslate nohighlight">\(F, L, H\)</span> are not time varying; these have the more restricted form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = F x(t) + L w(t),\\
&amp;f(t) = H x(t)\end{split}\]</div>
<p>…with <span class="math notranslate nohighlight">\(w(t)\)</span> white noise process with spectral density <span class="math notranslate nohighlight">\(Q_c\)</span>, where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;x ∈ ℝ^d\\
&amp;F, L ∈ ℝ^{d × d}\\
&amp;H ∈ ℝ^{d × o}\\
&amp;Q_c ∈ ℝ^d\\
&amp;d \verb|is the state dimension|\\
&amp;o \verb|is the observation dimension|\end{split}\]</div>
<p>See the documentation for the <a class="reference internal" href="#markovflow.kernels.StationaryKernel" title="markovflow.kernels.StationaryKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StationaryKernel</span></code></a> class.</p>
<p>Usually:</p>
<div class="math notranslate nohighlight">
\[x(t) = [a(t), da(t)/dt, d²a(t)/dt ...]\]</div>
<p>…for some <span class="math notranslate nohighlight">\(a(t)\)</span>, so the state dimension represents the degree of the stochastic
differential equation in terms of <span class="math notranslate nohighlight">\(a(t)\)</span>. Writing it in the above form is a standard
trick for converting a higher order linear differential equation into a first order linear one.</p>
<p>Since <span class="math notranslate nohighlight">\(F, L, H\)</span> are constant matrices, the solution can be written analytically.
For a given set of time points <span class="math notranslate nohighlight">\(tₖ\)</span>, we can solve this SDE and define a state
space model of the form:</p>
<div class="math notranslate nohighlight">
\[xₖ₊₁ = Aₖ xₖ + bₖ + qₖ\]</div>
<p>…where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;qₖ \sim 𝓝(0, Qₖ)\\
&amp;x₀ \sim 𝓝(μ₀, P₀)\\
&amp;xₖ ∈ ℝ^d\\
&amp;Aₖ ∈ ℝ^{d × d}\\
&amp;bₖ ∈ ℝ^d\\
&amp;Qₖ ∈ ℝ^{d × d}\\
&amp;μ₀ ∈ ℝ^{d × 1}\\
&amp;P₀ ∈ ℝ^{d × d}\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(Δtₖ = tₖ₊₁ - tₖ\)</span>, then the transition matrix <span class="math notranslate nohighlight">\(Aₜ\)</span> between states
<span class="math notranslate nohighlight">\(x(tₖ)\)</span> and <span class="math notranslate nohighlight">\(x(tₖ₊₁)\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[Aₖ = exp(FΔtₖ)\]</div>
<p>The process noise covariance matrix <span class="math notranslate nohighlight">\(Qₖ\)</span> between states <span class="math notranslate nohighlight">\(x(tₖ)\)</span> and
<span class="math notranslate nohighlight">\(x(tₖ₊₁)\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[Qₖ = ∫ exp(F (Δtₖ - τ)) L Q_c Lᵀ exp(F (Δtₖ - τ))ᵀ dτ\]</div>
<p>We can write this in terms of the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span> as:</p>
<div class="math notranslate nohighlight">
\[Qₖ = P∞ - Aₖ P∞ Aₖᵀ\]</div>
<p>We also define an emission model for a given output dimension:</p>
<div class="math notranslate nohighlight">
\[fₖ = H xₖ\]</div>
<p>…where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;x ∈ ℝ^d\\
&amp;f ∈ ℝ^m\\
&amp;H ∈ ℝ^{m × d}\\
&amp;m \verb| is the output_dim|\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.output_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">output_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.output_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the output dimension of the kernel.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.build_finite_distribution">
<code class="sig-name descname"><span class="pre">build_finite_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../gauss_markov/index.html#markovflow.gauss_markov.GaussMarkovDistribution" title="markovflow.gauss_markov.GaussMarkovDistribution"><span class="pre">markovflow.gauss_markov.GaussMarkovDistribution</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.build_finite_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="../gauss_markov/index.html#markovflow.gauss_markov.GaussMarkovDistribution" title="markovflow.gauss_markov.GaussMarkovDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussMarkovDistribution</span></code></a> that this kernel
represents on the provided time points.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently the only representation we can use is
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The times between which to define the distribution, with
shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.state_space_model">
<code class="sig-name descname"><span class="pre">state_space_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><span class="pre">markovflow.state_space_model.StateSpaceModel</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.state_space_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> that this
kernel represents on the provided time points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The times between which to define the state space model, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>. This must be strictly increasing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmissionModel</span></code></a> associated with this kernel
that maps from the latent <a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>
to the observations.</p>
<p>For any <a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SDEKernel</span></code></a>, the state representation is usually:</p>
<div class="math notranslate nohighlight">
\[x(t) = [a(t), da(t)/dt, d²a(t)/dt ...] \verb| for some | a(t)\]</div>
<p>In this case, we are interested only in the first element of <span class="math notranslate nohighlight">\(x\)</span>. That is, the
output <span class="math notranslate nohighlight">\(f(t)\)</span> is given by <span class="math notranslate nohighlight">\(f(t) = a(t)\)</span>, so <span class="math notranslate nohighlight">\(H\)</span> is given by
<span class="math notranslate nohighlight">\([1, 0, 0, ...]\)</span>.</p>
<p>If different behaviour is required, this method should be overridden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.initial_mean">
<code class="sig-name descname"><span class="pre">initial_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/TensorShape" title="(in TensorFlow v2.4)"><span class="pre">tf.TensorShape</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.initial_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial mean of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_shape</strong> – Leading dimensions for the initial mean.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of zeros with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.initial_covariance">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">initial_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time_point</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.initial_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial covariance of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>For stationary kernels this is typically the covariance of the stationary distribution for
<span class="math notranslate nohighlight">\(x, P∞\)</span>.</p>
<p>In the general case the initial covariance depends on time, so we  need the
<code class="xref any docutils literal notranslate"><span class="pre">initial_time_point</span></code> to generate it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_time_point</strong> – The time_point associated with the first state, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[1,]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.transition_statistics_from_time_points">
<code class="sig-name descname"><span class="pre">transition_statistics_from_time_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#markovflow.kernels.SDEKernel.transition_statistics_from_time_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the transition matrices when the time deltas are
between adjacent <a class="reference internal" href="../models/gaussian_process_regression/index.html#markovflow.models.gaussian_process_regression.GaussianProcessRegression.time_points" title="markovflow.models.gaussian_process_regression.GaussianProcessRegression.time_points"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">time_points</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions</span> <span class="pre">+</span> <span class="pre">1]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two tensors, with respective shapes
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.transition_statistics">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">transition_statistics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.SDEKernel.transition_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="#markovflow.kernels.SDEKernel.state_transitions" title="markovflow.kernels.SDEKernel.state_transitions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_transitions()</span></code></a> and <a class="reference internal" href="#markovflow.kernels.SDEKernel.process_covariances" title="markovflow.kernels.SDEKernel.process_covariances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_covariances()</span></code></a> together to
save having to compute them twice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two tensors, with respective shapes
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.state_offsets">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">state_offsets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.state_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state offsets <span class="math notranslate nohighlight">\(bₖ\)</span> of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.state_transitions">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> <span class="math notranslate nohighlight">\(Aₖ = exp(FΔtₖ)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – Time points at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – Time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.process_covariances">
<code class="sig-name descname"><span class="pre">process_covariances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.process_covariances" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the process covariance matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>The process covariance at time <span class="math notranslate nohighlight">\(k\)</span> is calculated as:</p>
<div class="math notranslate nohighlight">
\[Qₖ = P∞ - Aₖ P∞ Aₖᵀ\]</div>
<p>These transition matrices can be overridden for more specific use cases if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – Time points at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – Time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.jitter_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">jitter_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.jitter_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Jitter to add to the output of <a class="reference internal" href="#markovflow.kernels.SDEKernel.process_covariances" title="markovflow.kernels.SDEKernel.process_covariances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_covariances()</span></code></a> and
<a class="reference internal" href="#markovflow.kernels.SDEKernel.initial_covariance" title="markovflow.kernels.SDEKernel.initial_covariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initial_covariance()</span></code></a> shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.__add__">
<code class="sig-name descname"><span class="pre">__add__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#markovflow.kernels.Sum" title="markovflow.kernels.Sum"><span class="pre">Sum</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator for combining kernel objects by summing them.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.SDEKernel.__mul__">
<code class="sig-name descname"><span class="pre">__mul__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#markovflow.kernels.Product" title="markovflow.kernels.Product"><span class="pre">Product</span></a><a class="headerlink" href="#markovflow.kernels.SDEKernel.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator for combining kernel objects by multiplying them.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.StackKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">StackKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#StackKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.StackKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.StationaryKernel" title="markovflow.kernels.StationaryKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StationaryKernel</span></code></a></p>
<p>Implements the state space model of multiple kernels that have been combined together.
Unlike a <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a>, it manages the multiple
kernels by introducing a leading dimension (stacking), rather than forming a block
diagonal form of each parameter explicitly.</p>
<p>The prior of both a <a class="reference internal" href="#markovflow.kernels.StackKernel" title="markovflow.kernels.StackKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StackKernel</span></code></a> and a <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a> is the same (independent).
However, posterior state space models built upon a <a class="reference internal" href="#markovflow.kernels.StackKernel" title="markovflow.kernels.StackKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StackKernel</span></code></a> will maintain this
independency, in contrast to the posteriors building upon a <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a>,
which model correlations between the processes.</p>
<p>Combined with different emission models this can give rise to a multi-output stack
kernel, and perhaps in the future an additive kernel.</p>
<p>The state space of this kernel consists of all the state space of the child kernels
stacked (in the tensorflow.stack sense) together, with padded zeros when the state space
of one of the kernels is larger than any of the others:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[ x₁⁽¹⁾(t) ] ᨞
[   0   ]   [ x₁⁽ᵐ⁾(t) ]
          ᨞ [ x₂⁽ᵐ⁾(t) ]
</pre></div>
</div>
<p>…where <span class="math notranslate nohighlight">\(m\)</span> are the number of kernels / outputs.</p>
<p>So the SDE of the kernel becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dx(t)/dt = [F⁽¹⁾] ᨞   [x⁽¹⁾(t)] ᨞    + [L⁽¹⁾] ᨞    [w⁽¹⁾(t)] ᨞
              ᨞ [F⁽ᵐ⁾]   ᨞ [x⁽ᵐ⁾(t)]      ᨞ [L⁽ᵐ⁾]    ᨞ [w⁽ᵐ⁾(t)]

f(t) = [H⁽¹⁾] ᨞   [x⁽¹⁾(t)] ᨞
          ᨞ [H⁽ᵐ⁾]   ᨞ [x⁽ᵐ⁾(t)]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – A list of child kernels that will have their state spaces
concatenated together. Since we model each output independently, the length of the
kernel list defines the number of the outputs. Note that each kernel should have
individual <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel.output_dim" title="markovflow.emission_model.EmissionModel.output_dim"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">output_dim</span></code></a> 1.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.StackKernel.state_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.state_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dimension of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.kernels">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kernels</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.StackKernel.kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of child kernels.</p>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel._check_batch_shape_is_compatible">
<code class="sig-name descname"><span class="pre">_check_batch_shape_is_compatible</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/TensorShape" title="(in TensorFlow v2.4)"><span class="pre">tf.TensorShape</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel._check_batch_shape_is_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to check the compatibility of batch_shape.
For the <a class="reference internal" href="#markovflow.kernels.StackKernel" title="markovflow.kernels.StackKernel"><code class="xref any py py-class docutils literal notranslate"><span class="pre">StackKernel</span></code></a> the batch_shape must have the following shape:</p>
<blockquote>
<div><p>(…, num_kernels)</p>
</div></blockquote>
<p>In any other case this method raises a tf.errors.InvalidArgumentError.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_shape</strong> – a tuple with the shape to check</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.state_transitions">
<code class="sig-name descname"><span class="pre">state_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.state_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state transition matrices of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a> <span class="math notranslate nohighlight">\(Aₖ = exp(FΔtₖ)\)</span>.</p>
<p>The state transition matrix is the stacked matrix of the child state
transition matrices, padded with zeros (if necessary) to match the largest state dim
across kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code> where <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">=</span> <span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>
where <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">=</span> <span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.initial_mean">
<code class="sig-name descname"><span class="pre">initial_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/TensorShape" title="(in TensorFlow v2.4)"><span class="pre">tf.TensorShape</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.initial_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial mean of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.</p>
<p>We override <a class="reference internal" href="#markovflow.kernels.SDEKernel.initial_mean" title="markovflow.kernels.SDEKernel.initial_mean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SDEKernel.initial_mean()</span></code></a> from the
parent class to check there is a compatible <a class="reference internal" href="../block_tri_diag/index.html#markovflow.block_tri_diag.BlockTriDiagonal.batch_shape" title="markovflow.block_tri_diag.BlockTriDiagonal.batch_shape"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">batch_shape</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_shape</strong> – A tuple of leading dimensions for the initial mean, where batch_shape
can be <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of zeros with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim]</span></code>, where
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">=</span> <span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.state_offsets">
<code class="sig-name descname"><span class="pre">state_offsets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.state_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state offsets <span class="math notranslate nohighlight">\(bₖ\)</span> of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.</p>
<p>We override <a class="reference internal" href="#markovflow.kernels.SDEKernel.state_offsets" title="markovflow.kernels.SDEKernel.state_offsets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SDEKernel.state_offsets()</span></code></a> from the
parent class to check there is a compatible <a class="reference internal" href="../block_tri_diag/index.html#markovflow.block_tri_diag.BlockTriDiagonal.batch_shape" title="markovflow.block_tri_diag.BlockTriDiagonal.batch_shape"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">batch_shape</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix. This is the stacked matrix of child feedback matrices, padded
with zeros to have matching state dims.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[num_kernels,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance. This is the stacked matrix of child steady state
covariance matrices, padded with the identity (if necessary) to have matching state dims.</p>
<p>Note that we further append a singleton dimensions after the <code class="xref any docutils literal notranslate"><span class="pre">num_kernels</span></code> so it
can broadcast across the number of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[num_kernels,</span> <span class="pre">1,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StackKernel.initial_covariance">
<code class="sig-name descname"><span class="pre">initial_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time_point</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StackKernel.initial_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial covariance of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This is typically the covariance of the stationary distribution for <span class="math notranslate nohighlight">\(x, P∞\)</span>.</p>
<p>We override <a class="reference internal" href="#markovflow.kernels.SDEKernel.initial_covariance" title="markovflow.kernels.SDEKernel.initial_covariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SDEKernel.initial_covariance()</span></code></a> from the
parent class to check there is a compatible <a class="reference internal" href="../block_tri_diag/index.html#markovflow.block_tri_diag.BlockTriDiagonal.batch_shape" title="markovflow.block_tri_diag.BlockTriDiagonal.batch_shape"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">batch_shape</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_time_point</strong> – The time point associated with the first state, shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[1,]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">=</span> <span class="pre">(...,</span> <span class="pre">num_kernels)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.StationaryKernel">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">StationaryKernel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#StationaryKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SDEKernel</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstract class representing stationary kernels defined by the Stochastic Differential Equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;dx(t)/dt = F x(t) + L w(t),\\
&amp;f(t) = H(t) x(t)\end{split}\]</div>
<p>For most kernels <span class="math notranslate nohighlight">\(H\)</span> will not be time varying; that is, <span class="math notranslate nohighlight">\(f(t) = H x(t)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dim</strong> – The output dimension of the kernel.</p></li>
<li><p><strong>state_mean</strong> – A tensor with shape [state_dim,].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.initial_mean">
<code class="sig-name descname"><span class="pre">initial_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/TensorShape" title="(in TensorFlow v2.4)"><span class="pre">tf.TensorShape</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.initial_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial mean of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>This will usually be zero, but can be overridden if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_shape</strong> – Leading dimensions for the initial mean.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of zeros with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.set_state_mean">
<code class="sig-name descname"><span class="pre">set_state_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#markovflow.kernels.StationaryKernel.set_state_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the state mean for the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_mean</strong> – A tensor with shape [state_dim,].</p></li>
<li><p><strong>trainable</strong> – Boolean value to set the state mean trainable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.initial_covariance">
<code class="sig-name descname"><span class="pre">initial_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_time_point</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.initial_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the initial covariance of the generated
<a class="reference internal" href="../state_space_model/index.html#markovflow.state_space_model.StateSpaceModel" title="markovflow.state_space_model.StateSpaceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceModel</span></code></a>.</p>
<p>For stationary kernels this is the covariance of the stationary distribution for
<span class="math notranslate nohighlight">\(x,P∞\)</span> and is independent of the time passed in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_time_point</strong> – The time point associated with the first state, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[1,]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.transition_statistics">
<code class="sig-name descname"><span class="pre">transition_statistics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#markovflow.kernels.StationaryKernel.transition_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_transitions()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">process_covariances()</span></code> together to save
having to compute them twice.</p>
<p>By default this uses the state transitions to calculate the process covariance:</p>
<div class="math notranslate nohighlight">
\[Qₖ = P∞ - Aₖ P∞ Aₖᵀ\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two tensors, with respective shapes
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.feedback_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">feedback_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.feedback_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the feedback matrix <span class="math notranslate nohighlight">\(F\)</span>. This is where:</p>
<div class="math notranslate nohighlight">
\[dx(t)/dt = F x(t) + L w(t)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.state_offsets">
<code class="sig-name descname"><span class="pre">state_offsets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.state_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(dx = F (x - m)dt         o  x(t) = A x(0) + (I-A)m\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_times</strong> – A tensor of times at which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
<li><p><strong>time_deltas</strong> – A tensor of time gaps for which to produce matrices, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_transitions,</span> <span class="pre">state_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.steady_state_covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">steady_state_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.steady_state_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the steady state covariance <span class="math notranslate nohighlight">\(P∞\)</span>, given implicitly by:</p>
<div class="math notranslate nohighlight">
\[F P∞ + P∞ Fᵀ + LQ_cLᵀ = 0\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="markovflow.kernels.StationaryKernel.state_mean">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">state_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a><a class="headerlink" href="#markovflow.kernels.StationaryKernel.state_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor with shape <code class="docutils literal notranslate"><span class="pre">[state_dim,]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="markovflow.kernels.Sum">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Sum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#markovflow.kernels.SDEKernel" title="markovflow.kernels.SDEKernel"><span class="pre">SDEKernel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/markovflow/kernels/sde_kernel.html#Sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#markovflow.kernels.Sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#markovflow.kernels.ConcatKernel" title="markovflow.kernels.ConcatKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConcatKernel</span></code></a></p>
<p>Sums a list of child kernels.</p>
<p>There are two ways to implement this kernel: Stacked and Concatenated.</p>
<p>This class implements the Concatenated version, where the state space of the <a class="reference internal" href="#markovflow.kernels.Sum" title="markovflow.kernels.Sum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sum</span></code></a>
kernel includes covariance terms between the child kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> – A list of child kernels that will have their state spaces
concatenated together.</p></li>
<li><p><strong>jitter</strong> – A small non-negative number to add into a matrix’s diagonal to
maintain numerical stability during inversion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="markovflow.kernels.Sum.generate_emission_model">
<code class="sig-name descname"><span class="pre">generate_emission_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><span class="pre">tf.Tensor</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../emission_model/index.html#markovflow.emission_model.EmissionModel" title="markovflow.emission_model.EmissionModel"><span class="pre">markovflow.emission_model.EmissionModel</span></a><a class="headerlink" href="#markovflow.kernels.Sum.generate_emission_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the emission matrix <span class="math notranslate nohighlight">\(H\)</span>. This is the concatenation:</p>
<div class="math notranslate nohighlight">
\[H = [H₁, H₂, ..., Hₙ]\]</div>
<p>…where <span class="math notranslate nohighlight">\(\{Hᵢ\}ₙ\)</span> are the emission matrices of the child kernels. Thus the state
dimension for this kernel is the sum of the state dimension of the child kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_points</strong> – The time points over which the emission model is defined, with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The emission model associated with this kernel, with emission matrix with shape
<code class="docutils literal notranslate"><span class="pre">batch_shape</span> <span class="pre">+</span> <span class="pre">[num_data,</span> <span class="pre">output_dim,</span> <span class="pre">state_dim]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright Copyright 2021 The markovflow Contributors

Licensed under the Apache License, Version 2.0
.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>